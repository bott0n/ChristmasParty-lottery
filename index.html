<!Doctype html>
<html>
    <head>
          <meta charset="UTF-8">
        <script>
           const classNum=30;
          

          var isDataFull = false

          var arrayNum=0;
          var giftNum=0;
            
            var saveArray =[];





             
          
           //localStorage.setItem("array", '');
           document.addEventListener("DOMContentLoaded", function(event) { 
           load()
});
            
            

           function load(){
           console.log('start load')
            array = JSON.parse(localStorage.getItem("array"));
             for(i=0;i<array.length;i++){
                saveArray.push(array[i])
               
                arrayNum=i
                giftNum++
                console.log('load',giftNum)
                document.getElementsByClassName('output')[0].innerHTML += 
                giftNum+'號的禮物是:'+" "+array[arrayNum]+' 號同學的禮物'+'\n';
                
                
             }
            arrayNum++
           
             
           }
             
            

           
            function getNum(){
             var num= Math.floor((Math.random()*30+1))
             return num
             //document.getElementsByClassName('output')[0].innerHTML += num+','
            }
            
            function check(){
              
              randomNum =0
              
              do{
              randomNum=getNum()
              }
              while(saveArray.indexOf(randomNum)!==-1)
                saveArray.push(randomNum)

                localStorage.setItem("array", JSON.stringify(saveArray));
            }
             
            function run(){
              if(giftNum <30)
              {
               check()

               giftNum++

               array = JSON.parse(localStorage.getItem("array"));
               console.log('giftNum run',giftNum)
               console.log('run',localStorage.array)
               document.getElementsByClassName('output')[0].innerHTML += 
                 giftNum+'號的禮物是:'+" "+array[arrayNum]+' 號同學的禮物'+'\n'

                arrayNum++
               
              


              console.log(saveArray)
              }
              else{
                console.log('full')
                document.getElementsByClassName('output')[0].innerHTML = 'datafull\n'+'please reload this page'
                
                
               localStorage.setItem('array','')


               isDataFull=true
               
              }
              
            
            }
            
            </script>
            <style>.main{
                margin:20px auto;
                width:500px;
                
              }
              .btn{
                width:200px;
                height:50px;
                
                margin:50px auto;
                background:green;
                 border: 3px solid green;
                border-radius: 25px;
                
                color:black;
                font-size:24px;
                box-shadow:black 2px 5px 5px;
                
              }
              
              .output{
                width:500px;
                height:1000px;
                background:skyblue; 
                font-size:20px;
                
                overflow:hidden;
               
                readonly:ture;
              }
              
              
              .menu{
                position: fixed;
                width:200px;
                height:500px;
                background:#00AAFF
              }</style>
    </head>
    <body>
        <div class='menu'>
            <button class='btn' onClick='run()'>click me</button>
           
            </div>
            <div class='main'>
            
            
            <span>Output here:</span>
            <textarea class='output'></textarea>
            
            </div>
            
    </body>
</html>